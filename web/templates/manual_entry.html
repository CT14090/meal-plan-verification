{% extends "base.html" %} {% block title %}Manual Entry{% endblock %} {% block
styles %}
<style>
  body {
    overflow: hidden !important;
  }
  .container {
    height: 100vh;
    overflow: hidden;
  }
</style>
{% endblock %} {% block content %}
<div class="container">
  <div class="card" id="entry-card">
    <div class="header">
      <h1>üî¢ Manual Student Entry</h1>
      <div class="station">{{ station_name }}</div>
    </div>

    <div class="message">Enter Student ID</div>

    <div style="margin: 40px 0">
      <input
        type="text"
        id="student-id"
        placeholder="Student ID"
        autofocus
        style="
          font-size: 32px;
          padding: 20px;
          width: 100%;
          max-width: 400px;
          border: 3px solid #667eea;
          border-radius: 12px;
          text-align: center;
        "
      />

      <div style="margin-top: 30px">
        <button onclick="lookupStudent()" class="btn btn-success">
          ‚úì Lookup Student
        </button>
        <a href="/" class="btn btn-secondary">‚Üê Back</a>
      </div>
    </div>

    <div id="result"></div>
  </div>
</div>

<script>
  function lookupStudent() {
    const studentId = document.getElementById("student-id").value.trim();
    const resultDiv = document.getElementById("result");

    if (!studentId) {
      alert("Please enter a student ID");
      return;
    }

    resultDiv.innerHTML = '<div class="loading"></div>';

    fetch("/api/manual-lookup", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ student_id: studentId }),
    })
      .then((response) => response.json())
      .then((data) => {
        if (data.success) {
          showStudent(data.student, data.eligibility);
        } else {
          resultDiv.innerHTML =
            '<div class="status-badge status-error">‚ùå Student Not Found</div>';
        }
      })
      .catch((error) => {
        resultDiv.innerHTML =
          '<div class="status-badge status-error">‚ùå Error: ' +
          error.message +
          "</div>";
      });
  }

  function showStudent(student, eligibility) {
    // Navigate to student-info page instead of showing inline
    window.location.href = "/student-info?student=" + student.student_id;
  }

  function clearCountdown() {
    if (window.currentCountdown) {
      clearInterval(window.currentCountdown);
    }
  }

  document
    .getElementById("student-id")
    .addEventListener("keypress", function (e) {
      if (e.key === "Enter") {
        lookupStudent();
      }
    });
</script>
{% endblock %}
